# 数据库中的锁

## 悲观锁

每次去拿数据的时候都认为别人会修改，所以每次在拿数据的时候都会上锁，这样别人想拿这个数据就会 block 直到它拿到锁。

### 读锁

在读取过程中，不希望别人修改，并且自己也不会修改。我们可以给读取的数据加入读锁。

```mysql
-- 读锁、共享锁
select * from table lock in share mode;
```

### 写锁

我不仅要读还要对数据进行修改，我就可以为我读取的数据加上写锁。

```mysql
-- 写锁、排它锁
select * from table for update;
```

## 乐观锁

每次去拿数据的时候都认为别人不会修改，所以不会上锁，但是在提交更新的时候会判断一下在此期间别人有没有去更新这个数据。乐观锁适用于读多写少的应用场景，这样可以提高吞吐量。

例如，使用 version 来控制。